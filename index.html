<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Form Builder</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Modern Animations */
        .fade-in { animation: fadeIn 0.6s cubic-bezier(0.4, 0, 0.2, 1); }
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(20px) scale(0.95); } 
            to { opacity: 1; transform: translateY(0) scale(1); } 
        }
        
        .slide-in { animation: slideIn 0.8s cubic-bezier(0.4, 0, 0.2, 1); }
        @keyframes slideIn { 
            from { opacity: 0; transform: translateX(-30px); } 
            to { opacity: 1; transform: translateX(0); } 
        }
        
                 .pulse-glow { animation: pulseGlow 3s ease-in-out infinite; }
         @keyframes pulseGlow { 
             0%, 100% { box-shadow: 0 0 30px rgba(59, 130, 246, 0.4); } 
             50% { box-shadow: 0 0 50px rgba(59, 130, 246, 0.8), 0 0 80px rgba(147, 51, 234, 0.4); } 
         }
        
        .float { animation: float 6s ease-in-out infinite; }
        @keyframes float { 
            0%, 100% { transform: translateY(0px); } 
            50% { transform: translateY(-10px); } 
        }
        
        .shimmer { animation: shimmer 2s linear infinite; }
        @keyframes shimmer { 
            0% { background-position: -200% 0; } 
            100% { background-position: 200% 0; } 
        }
        
                 /* Advanced Gradients */
         .gradient-bg { 
             background: linear-gradient(135deg, #1e3a8a 0%, #3730a3 50%, #7c3aed 100%);
             background-size: 200% 200%;
             animation: gradientShift 20s ease infinite;
             min-height: 100vh;
             overflow-x: hidden;
             overflow-y: auto;
         }
        @keyframes gradientShift { 
            0% { background-position: 0% 50%; } 
            50% { background-position: 100% 50%; } 
            100% { background-position: 0% 50%; } 
        }
        
                 .glass { 
             backdrop-filter: blur(20px) saturate(180%);
             background: rgba(255, 255, 255, 0.12);
             border: 1px solid rgba(255, 255, 255, 0.2);
             box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
         }
        
        .glass-dark { 
            backdrop-filter: blur(20px) saturate(180%);
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }
        
                 /* Enhanced Buttons */
         .btn-glow:hover { 
             box-shadow: 0 0 30px rgba(59, 130, 246, 0.6), 0 0 60px rgba(147, 51, 234, 0.3);
             transform: translateY(-3px) scale(1.02);
             transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
         }
        
        .btn-shimmer {
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            background-size: 200% 100%;
            animation: shimmer 3s linear infinite;
        }
        
                 /* Card Effects */
         .card-hover:hover { 
             transform: translateY(-8px) scale(1.02);
             box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15), 0 0 30px rgba(59, 130, 246, 0.2);
             transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
         }
        
                 /* Input Styling */
         .input-glow:focus {
             box-shadow: 0 0 20px rgba(59, 130, 246, 0.4), 0 0 40px rgba(147, 51, 234, 0.2);
             transform: scale(1.02);
             transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
         }
        
        /* Particle Effect */
        .particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
        }
        
        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: rgba(255, 255, 255, 0.4);
            border-radius: 50%;
            animation: particleFloat 30s linear infinite;
        }
        
        @keyframes particleFloat {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100px) rotate(180deg); opacity: 0; }
        }
        
        /* Subtle Text Glow */
        .text-glow {
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.3);
        }
        
        /* Loading Spinner */
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #fff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
                 /* Responsive Design */
         @media (max-width: 768px) {
             .container { padding: 1rem; }
             .text-5xl { font-size: 2.5rem; }
             .text-2xl { font-size: 1.5rem; }
             
             /* Mobile-specific optimizations */
             .glass { 
                 backdrop-filter: blur(15px) saturate(150%);
                 background: rgba(255, 255, 255, 0.15);
                 border: 1px solid rgba(255, 255, 255, 0.25);
             }
             
             /* Larger touch targets */
             button, input, select, textarea {
                 min-height: 44px;
                 font-size: 16px !important; /* Prevents zoom on iOS */
             }
             
                      /* Mobile-friendly spacing */
         .mb-8 { margin-bottom: 1.5rem; }
         .p-8 { padding: 1.5rem; }
         .px-6 { padding-left: 1rem; padding-right: 1rem; }
         .py-4 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
         
         /* Touch-friendly interactions */
         button, input, select, textarea {
             -webkit-tap-highlight-color: transparent;
             touch-action: manipulation;
         }
         
         /* Prevent text selection on buttons */
         button {
             -webkit-user-select: none;
             -moz-user-select: none;
             -ms-user-select: none;
             user-select: none;
         }
             
             /* Stack buttons vertically on mobile */
             .flex.space-x-4 {
                 flex-direction: column;
                 gap: 0.75rem;
             }
             
             /* Mobile modal adjustments */
             .glass-dark {
                 margin: 1rem;
                 padding: 1.5rem;
                 max-width: calc(100vw - 2rem);
             }
         }
         
         /* Extra small devices */
         @media (max-width: 480px) {
             .text-5xl { font-size: 2rem; }
             .text-4xl { font-size: 1.75rem; }
             .text-3xl { font-size: 1.5rem; }
             
             .container { padding: 0.5rem; }
             
             /* Compact mobile layout */
             .p-8 { padding: 1rem; }
             .mb-8 { margin-bottom: 1rem; }
             
             /* Single column grid on very small screens */
             .grid.grid-cols-1.md\\:grid-cols-3 {
                 grid-template-columns: 1fr;
             }
         }
         
         /* Fix scrolling issues */
         body {
             overflow-x: hidden;
             overflow-y: auto;
             scroll-behavior: smooth;
             min-height: 100vh;
             -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
         }
         
         html {
             scroll-behavior: smooth;
             height: 100%;
         }
         
         /* Dropdown styling */
         select option {
             background-color: #1f2937 !important;
             color: white !important;
             padding: 8px 12px;
         }
         
         select option:hover {
             background-color: #374151 !important;
         }
         
         select option:checked {
             background-color: #3b82f6 !important;
         }
    </style>
</head>
 <body class="min-h-screen gradient-bg relative">
    <!-- Particle Background -->
    <div class="particles" id="particles"></div>
    
         <div class="container mx-auto px-4 py-8 max-w-6xl relative z-10">
        <div class="text-center mb-12 fade-in">
            <div class="mb-8">
                <div class="w-20 h-20 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full mx-auto flex items-center justify-center shadow-lg mb-4">
                    <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                </div>
            </div>
            <h1 class="text-5xl font-bold text-white mb-4">Form Builder Pro</h1>
            <p class="text-xl text-white/80 max-w-2xl mx-auto leading-relaxed mb-6">Create professional Google Forms with AI assistance</p>
            <div class="flex justify-center space-x-6">
                <div class="flex items-center space-x-2 text-white/70">
                    <div class="w-2 h-2 bg-green-400 rounded-full"></div>
                    <span class="text-sm">AI-Powered</span>
                </div>
                <div class="flex items-center space-x-2 text-white/70">
                    <div class="w-2 h-2 bg-blue-400 rounded-full"></div>
                    <span class="text-sm">Real-time Preview</span>
                </div>
                <div class="flex items-center space-x-2 text-white/70">
                    <div class="w-2 h-2 bg-purple-400 rounded-full"></div>
                    <span class="text-sm">Instant Creation</span>
                </div>
            </div>
        </div>

        <div id="formContainer" class="flex justify-center">
            <div class="w-full max-w-2xl">
                <div class="glass rounded-3xl p-8 card-hover transition-all duration-300 slide-in">
                <div class="flex items-center mb-8">
                    <div class="w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl flex items-center justify-center mr-4">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                    </div>
                    <h2 class="text-3xl font-bold text-white">Form Configuration</h2>
                </div>
                
                <div class="mb-8">
                    <label class="block text-white font-semibold mb-3 text-lg">🎯 Form Title</label>
                    <input type="text" id="formTitle" placeholder="Enter your form title..." class="w-full px-6 py-4 rounded-2xl bg-white/10 text-white placeholder-white/60 border border-white/20 focus:border-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-400/50 transition-all input-glow text-lg">
                </div>

                <div class="mb-8">
                    <label class="block text-white font-semibold mb-3 text-lg">❓ Question Text</label>
                    <input type="text" id="questionText" placeholder="Enter your question..." class="w-full px-6 py-4 rounded-2xl bg-white/10 text-white placeholder-white/60 border border-white/20 focus:border-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-400/50 transition-all input-glow text-lg">
                </div>

                <div class="mb-8">
                    <label class="block text-white font-semibold mb-3 text-lg">📋 Question Type</label>
                                         <select id="questionType" class="w-full px-6 py-4 rounded-2xl bg-white/10 text-white border border-white/20 focus:border-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-400/50 transition-all input-glow text-lg">
                         <option value="Short Answer" class="bg-gray-800 text-white">Short Answer</option>
                         <option value="Paragraph" class="bg-gray-800 text-white">Paragraph</option>
                         <option value="Multiple Choice" class="bg-gray-800 text-white">Multiple Choice</option>
                         <option value="Checkboxes" class="bg-gray-800 text-white">Checkboxes</option>
                         <option value="Dropdown" class="bg-gray-800 text-white">Dropdown</option>
                     </select>
                </div>

                <div id="optionsSection" class="mb-8 hidden">
                    <label class="block text-white font-semibold mb-4 text-lg">⚙️ Options Configuration</label>
                    <div class="space-y-4">
                        <div class="grid grid-cols-3 gap-3">
                            <button onclick="setOptionMethod('manual')" id="manualBtn" class="px-6 py-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-2xl hover:from-blue-600 hover:to-blue-700 transition-all btn-glow font-semibold text-lg shadow-lg">✏️ Manual</button>
                            <button onclick="setOptionMethod('csv')" id="csvBtn" class="px-6 py-4 bg-white/20 text-white rounded-2xl hover:bg-white/30 transition-all font-semibold text-lg shadow-lg">📁 Upload CSV</button>
                            <button onclick="setOptionMethod('ai')" id="aiBtn" class="px-6 py-4 bg-white/20 text-white rounded-2xl hover:bg-white/30 transition-all font-semibold text-lg shadow-lg">🤖 AI Generate</button>
                        </div>
                        
                        <div id="manualOptions">
                            <textarea id="optionsText" placeholder="Option 1&#10;Option 2&#10;Option 3" class="w-full px-6 py-4 rounded-2xl bg-white/10 text-white placeholder-white/60 border border-white/20 focus:border-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-400/50 transition-all h-40 text-lg input-glow resize-none"></textarea>
                        </div>
                        
                        <div id="csvOptions" class="hidden">
                            <div class="border-2 border-dashed border-white/30 rounded-2xl p-8 text-center hover:border-white/50 transition-all">
                                <input type="file" id="csvFile" accept=".csv" class="w-full h-full absolute inset-0 opacity-0 cursor-pointer">
                                <div class="text-white/80">
                                    <svg class="w-12 h-12 mx-auto mb-4 text-white/60" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                                    </svg>
                                    <p class="text-lg font-semibold">Drop your CSV file here</p>
                                    <p class="text-sm opacity-75">or click to browse</p>
                                </div>
                            </div>
                        </div>
                        
                        <div id="aiOptions" class="hidden">
                                                     <div class="flex flex-col sm:flex-row gap-4">
                             <input type="number" id="numOptions" value="4" min="2" max="10" class="flex-1 px-6 py-4 rounded-2xl bg-white/10 text-white border border-white/20 focus:border-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-400/50 transition-all text-lg input-glow">
                             <button onclick="generateAIOptions()" class="px-8 py-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-2xl hover:from-purple-600 hover:to-pink-600 transition-all btn-glow font-semibold text-lg shadow-lg">🚀 Generate</button>
                         </div>
                            <div id="aiOptionsResult" class="mt-4 hidden"></div>
                        </div>
                    </div>
                </div>

                <div id="paragraphSection" class="mb-8 hidden">
                    <label class="block text-white font-semibold mb-4 text-lg">💡 AI Example Answers</label>
                                             <div class="flex flex-col sm:flex-row gap-4">
                             <input type="number" id="numExamples" value="3" min="1" max="10" class="flex-1 px-6 py-4 rounded-2xl bg-white/10 text-white border border-white/20 focus:border-blue-400 focus:outline-none focus:ring-2 focus:ring-blue-400/50 transition-all text-lg input-glow">
                             <button onclick="generateAIExamples()" class="px-8 py-4 bg-gradient-to-r from-green-500 to-blue-500 text-white rounded-2xl hover:from-green-600 hover:to-blue-600 transition-all btn-glow font-semibold text-lg shadow-lg">✨ Generate Examples</button>
                         </div>
                    <div id="aiExamplesResult" class="mt-4 hidden"></div>
                </div>

                <div class="mb-8">
                    <button onclick="generateFormWithAI()" class="w-full px-8 py-6 bg-gradient-to-r from-purple-500 via-pink-500 to-red-500 text-white rounded-2xl hover:from-purple-600 hover:via-pink-600 hover:to-red-600 transition-all btn-glow font-bold text-xl shadow-2xl mb-6 btn-shimmer">🤖 Generate Form with AI</button>
                </div>
                
                                 <div class="flex flex-col sm:flex-row gap-4">
                     <button onclick="addQuestion()" class="flex-1 px-8 py-6 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-2xl hover:from-blue-600 hover:to-purple-700 transition-all btn-glow font-bold text-lg shadow-lg">➕ Add Question</button>
                     <button onclick="clearForm()" class="px-8 py-6 bg-white/20 text-white rounded-2xl hover:bg-white/30 transition-all font-bold text-lg shadow-lg">🗑️ Clear</button>
                 </div>
            </div>
        </div>

        <div id="formPreviewSection" class="glass rounded-3xl p-8 card-hover transition-all duration-300 slide-in hidden">
                <div class="flex items-center mb-8">
                    <div class="w-12 h-12 bg-gradient-to-r from-green-500 to-teal-600 rounded-xl flex items-center justify-center mr-4">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                        </svg>
                    </div>
                    <h2 class="text-3xl font-bold text-white">Form Preview</h2>
                </div>
                <div id="questionsPreview" class="space-y-4 mb-8">
                    <div class="text-white/70 text-center py-12">
                        <div class="w-16 h-16 bg-white/10 rounded-full flex items-center justify-center mx-auto mb-4">
                            <svg class="w-8 h-8 text-white/50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                        </div>
                        <p class="text-lg font-semibold">No questions added yet</p>
                        <p class="text-sm opacity-75">Add your first question to see the preview!</p>
                    </div>
                </div>
                
                <div id="createFormSection" class="hidden">
                    <button onclick="createGoogleForm()" id="createFormBtn" class="w-full px-8 py-6 bg-gradient-to-r from-green-500 to-teal-600 text-white rounded-2xl hover:from-green-600 hover:to-teal-700 transition-all btn-glow font-bold text-xl pulse-glow shadow-2xl">🚀 Create Google Form</button>
                </div>
            </div>
        </div>

        <div id="loadingModal" class="fixed inset-0 bg-black/60 backdrop-blur-md hidden items-center justify-center z-50">
            <div class="glass-dark rounded-3xl p-12 max-w-md mx-4">
                <div class="text-center">
                    <div class="spinner mx-auto mb-6"></div>
                    <h3 class="text-2xl font-bold text-white mb-4 text-glow">Creating Your Form...</h3>
                    <p class="text-white/80 text-lg">Please wait while we generate your Google Form</p>
                    <div class="mt-6 flex justify-center space-x-2">
                        <div class="w-2 h-2 bg-blue-400 rounded-full animate-pulse"></div>
                        <div class="w-2 h-2 bg-purple-400 rounded-full animate-pulse" style="animation-delay: 0.2s;"></div>
                        <div class="w-2 h-2 bg-pink-400 rounded-full animate-pulse" style="animation-delay: 0.4s;"></div>
                    </div>
                </div>
            </div>
        </div>

                 <div id="successModal" class="fixed inset-0 bg-black/60 backdrop-blur-md hidden items-center justify-center z-50">
             <div class="glass-dark rounded-3xl p-12 max-w-md mx-4">
                 <div class="text-center">
                     <div class="w-20 h-20 bg-gradient-to-r from-green-400 to-green-600 rounded-full flex items-center justify-center mx-auto mb-6 shadow-2xl">
                         <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                             <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                         </svg>
                     </div>
                     <h3 class="text-3xl font-bold text-white mb-6 text-glow">Form Created Successfully!</h3>
                     <a id="formLink" href="#" target="_blank" class="inline-block px-8 py-4 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-2xl hover:from-blue-600 hover:to-purple-700 transition-all btn-glow mb-6 font-bold text-xl shadow-lg">🎉 View Your Form</a>
                     <div>
                         <button onclick="closeSuccessModal()" class="px-6 py-3 bg-white/20 text-white rounded-xl hover:bg-white/30 transition-all font-semibold">Close</button>
                     </div>
                 </div>
             </div>
         </div>

         <!-- Welcome Popup -->
         <div id="welcomeModal" class="fixed inset-0 bg-black/60 backdrop-blur-md flex items-center justify-center z-50 p-4">
             <div class="glass-dark rounded-3xl p-6 sm:p-8 md:p-12 max-w-2xl w-full mx-auto max-h-[90vh] overflow-y-auto">
                 <div class="text-center">
                     <div class="w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4 sm:mb-6 md:mb-8 shadow-2xl">
                         <svg class="w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                             <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                         </svg>
                     </div>
                     <h2 class="text-2xl sm:text-3xl md:text-4xl font-bold text-white mb-4 sm:mb-6 text-glow">Welcome to Form Builder Pro!</h2>
                     <p class="text-base sm:text-lg md:text-xl text-white/90 mb-6 sm:mb-8 leading-relaxed">The hassle-free Google Form creator powered by AI</p>
                     
                     <div class="grid grid-cols-1 md:grid-cols-3 gap-4 sm:gap-6 mb-6 sm:mb-8">
                         <div class="bg-white/10 rounded-2xl p-4 sm:p-6 border border-white/20">
                             <div class="w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-3 sm:mb-4">
                                 <span class="text-white font-bold text-base sm:text-lg">1</span>
                             </div>
                             <h3 class="text-white font-bold text-base sm:text-lg mb-2">Input Heading</h3>
                             <p class="text-white/80 text-xs sm:text-sm">Just enter your form title and let AI do the work</p>
                         </div>
                         <div class="bg-white/10 rounded-2xl p-4 sm:p-6 border border-white/20">
                             <div class="w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-r from-purple-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-3 sm:mb-4">
                                 <span class="text-white font-bold text-base sm:text-lg">2</span>
                             </div>
                             <h3 class="text-white font-bold text-base sm:text-lg mb-2">AI Generates</h3>
                             <p class="text-white/80 text-xs sm:text-sm">AI creates relevant questions with smart options</p>
                         </div>
                         <div class="bg-white/10 rounded-2xl p-4 sm:p-6 border border-white/20">
                             <div class="w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-r from-green-500 to-green-600 rounded-full flex items-center justify-center mx-auto mb-3 sm:mb-4">
                                 <span class="text-white font-bold text-base sm:text-lg">3</span>
                             </div>
                             <h3 class="text-white font-bold text-base sm:text-lg mb-2">Review & Create</h3>
                             <p class="text-white/80 text-xs sm:text-sm">Review, edit if needed, and create instantly</p>
                         </div>
                     </div>
                     
                     <div class="bg-yellow-500/20 border border-yellow-500/30 rounded-2xl p-3 sm:p-4 mb-4 sm:mb-6">
                         <div class="flex items-start space-x-2 sm:space-x-3">
                             <div class="w-5 h-5 sm:w-6 sm:h-6 bg-yellow-500 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5">
                                 <svg class="w-3 h-3 sm:w-4 sm:h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                     <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                                 </svg>
                             </div>
                             <div>
                                 <h4 class="text-yellow-300 font-semibold text-xs sm:text-sm mb-1">💡 Pro Tip</h4>
                                 <p class="text-yellow-200/90 text-xs sm:text-sm">If you encounter any errors or bugs, simply try again without reloading the page. The AI will generate fresh content each time!</p>
                             </div>
                         </div>
                     </div>
                     
                     <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center">
                         <button onclick="closeWelcomeModal()" class="px-6 sm:px-8 py-3 sm:py-4 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-2xl hover:from-blue-600 hover:to-purple-700 transition-all btn-glow font-bold text-base sm:text-lg shadow-lg">🚀 Get Started</button>
                         <button onclick="showTutorial()" class="px-6 sm:px-8 py-3 sm:py-4 bg-white/20 text-white rounded-2xl hover:bg-white/30 transition-all font-bold text-base sm:text-lg">📖 How It Works</button>
                     </div>
                 </div>
             </div>
         </div>
    </div>

    <script>
        // Replace with your Google Apps Script Web App URL
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby56SEBLDNZ6tuZGNNYdQKPVKEwAUf9nEoEeRFUuO_xnnHIP-axbNqWuID2EF0BAFqw_g/exec';
        const GEMINI_API_KEY = 'AIzaSyBWvOxGMQhotE9xibPay49Bm2SnTkrmd0U';
        const GEMINI_MODEL = 'gemini-2.5-pro';
        const GEMINI_URL = `https://generativelanguage.googleapis.com/v1beta/models/${GEMINI_MODEL}:generateContent?key=${GEMINI_API_KEY}`;

        let questions = [];
        let currentOptionMethod = 'manual';

        document.getElementById('questionType').addEventListener('change', function() {
            const type = this.value;
            const optionsSection = document.getElementById('optionsSection');
            const paragraphSection = document.getElementById('paragraphSection');
            
            if (['Multiple Choice', 'Checkboxes', 'Dropdown'].includes(type)) {
                optionsSection.classList.remove('hidden');
                paragraphSection.classList.add('hidden');
            } else if (type === 'Paragraph') {
                optionsSection.classList.add('hidden');
                paragraphSection.classList.remove('hidden');
            } else {
                optionsSection.classList.add('hidden');
                paragraphSection.classList.add('hidden');
            }
        });

        document.getElementById('csvFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const csv = e.target.result;
                    const options = parseCSV(csv);
                    document.getElementById('optionsText').value = options.join('\n');
                };
                reader.readAsText(file);
            }
        });

        function setOptionMethod(method) {
            currentOptionMethod = method;
            document.getElementById('manualBtn').className = method === 'manual' ? 'flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all btn-glow' : 'flex-1 px-4 py-2 bg-white/20 text-white rounded-lg hover:bg-white/30 transition-all';
            document.getElementById('csvBtn').className = method === 'csv' ? 'flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all btn-glow' : 'flex-1 px-4 py-2 bg-white/20 text-white rounded-lg hover:bg-white/30 transition-all';
            document.getElementById('aiBtn').className = method === 'ai' ? 'flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all btn-glow' : 'flex-1 px-4 py-2 bg-white/20 text-white rounded-lg hover:bg-white/30 transition-all';
            
            document.getElementById('manualOptions').classList.toggle('hidden', method !== 'manual');
            document.getElementById('csvOptions').classList.toggle('hidden', method !== 'csv');
            document.getElementById('aiOptions').classList.toggle('hidden', method !== 'ai');
        }

        function parseCSV(csv) {
            const lines = csv.trim().split('\n');
            return lines.map(line => {
                const firstComma = line.indexOf(',');
                return firstComma > -1 ? line.substring(0, firstComma).trim() : line.trim();
            }).filter(option => option);
        }

        async function callGeminiAPI(prompt) {
            try {
                const response = await fetch(GEMINI_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }] }]
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    return data.candidates[0].content.parts[0].text;
                } else {
                    throw new Error(`API Error: ${response.status}`);
                }
            } catch (error) {
                console.error('Gemini API Error:', error);
                return 'Error generating content';
            }
        }

        async function generateAIOptions() {
            const questionText = document.getElementById('questionText').value;
            const questionType = document.getElementById('questionType').value;
            const numOptions = document.getElementById('numOptions').value;
            
            if (!questionText.trim()) {
                alert('Please enter question text first');
                return;
            }

            const resultDiv = document.getElementById('aiOptionsResult');
            resultDiv.className = 'mt-3 p-3 bg-white/10 rounded-lg';
            resultDiv.innerHTML = '<div class="text-white">Generating options...</div>';

            const prompt = `Generate ${numOptions} appropriate options for this ${questionType.toLowerCase()} question: "${questionText}"\n\nReturn only the options, one per line, without numbers or bullet points. Make them realistic and relevant to the question.`;
            
            const response = await callGeminiAPI(prompt);
            const options = response.split('\n').filter(line => line.trim()).slice(0, numOptions);
            
            document.getElementById('optionsText').value = options.join('\n');
            resultDiv.innerHTML = `<div class="text-green-400 font-medium">✓ Generated ${options.length} options</div><div class="text-white/80 text-sm mt-1">${options.join(', ')}</div>`;
        }

        async function generateAIExamples() {
            const questionText = document.getElementById('questionText').value;
            const numExamples = document.getElementById('numExamples').value;
            
            if (!questionText.trim()) {
                alert('Please enter question text first');
                return;
            }

            const resultDiv = document.getElementById('aiExamplesResult');
            resultDiv.className = 'mt-3 p-3 bg-white/10 rounded-lg';
            resultDiv.innerHTML = '<div class="text-white">Generating examples...</div>';

            const prompt = `Generate ${numExamples} realistic example answers for this paragraph question: "${questionText}"\n\nEach example should be 1-3 sentences long and show different ways someone might respond. Return each example on a separate line.`;
            
            const response = await callGeminiAPI(prompt);
            const examples = response.split('\n').filter(line => line.trim()).slice(0, numExamples);
            
            resultDiv.innerHTML = `<div class="text-green-400 font-medium">✓ Generated ${examples.length} examples</div><div class="text-white/80 text-sm mt-2 space-y-1">${examples.map((ex, i) => `<div><strong>Example ${i+1}:</strong> ${ex}</div>`).join('')}</div>`;
        }

        function addQuestion() {
            const text = document.getElementById('questionText').value.trim();
            const type = document.getElementById('questionType').value;
            
            if (!text) {
                alert('Please enter question text');
                return;
            }

            let options = [];
            if (['Multiple Choice', 'Checkboxes', 'Dropdown'].includes(type)) {
                const optionsText = document.getElementById('optionsText').value.trim();
                if (!optionsText) {
                    alert('Please provide options for choice questions');
                    return;
                }
                options = optionsText.split('\n').map(opt => opt.trim()).filter(opt => opt);
            }

            const question = { text, type, options };
            questions.push(question);
            
            // Show the preview section when first question is added
            if (questions.length === 1) {
                // Change layout to side-by-side
                const formContainer = document.getElementById('formContainer');
                formContainer.className = 'grid grid-cols-1 lg:grid-cols-2 gap-8';
                
                // Show preview section
                document.getElementById('formPreviewSection').classList.remove('hidden');
                document.getElementById('formPreviewSection').classList.add('fade-in');
            }
            
            updatePreview();
            clearQuestionForm();
            
            document.getElementById('createFormSection').classList.remove('hidden');
        }

        function removeQuestion(index) {
            questions.splice(index, 1);
            updatePreview();
            if (questions.length === 0) {
                document.getElementById('createFormSection').classList.add('hidden');
                // Hide the preview section when no questions remain
                document.getElementById('formPreviewSection').classList.add('hidden');
                // Return to centered layout
                const formContainer = document.getElementById('formContainer');
                formContainer.className = 'flex justify-center';
            }
        }

        function updatePreview() {
            const preview = document.getElementById('questionsPreview');
            
            if (questions.length === 0) {
                preview.innerHTML = `
                    <div class="text-white/70 text-center py-12">
                        <div class="w-16 h-16 bg-white/10 rounded-full flex items-center justify-center mx-auto mb-4">
                            <svg class="w-8 h-8 text-white/50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                        </div>
                        <p class="text-lg font-semibold">No questions added yet</p>
                        <p class="text-sm opacity-75">Add your first question to see the preview!</p>
                    </div>
                `;
                return;
            }

            preview.innerHTML = questions.map((q, i) => `
                <div class="bg-white/10 rounded-2xl p-6 fade-in border border-white/10 hover:border-white/20 transition-all">
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <div class="flex items-center mb-3">
                                <div class="w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center mr-3">
                                    <span class="text-white font-bold text-sm">${i + 1}</span>
                                </div>
                                <h4 class="text-white font-bold text-lg">${q.text}</h4>
                            </div>
                            <div class="flex items-center space-x-4 mb-3">
                                <span class="px-3 py-1 bg-white/20 text-white rounded-full text-sm font-medium">${q.type}</span>
                                ${q.options.length > 0 ? `<span class="text-white/60 text-sm">${q.options.length} options</span>` : ''}
                            </div>
                            ${q.options.length > 0 ? `
                                <div class="bg-white/5 rounded-xl p-4">
                                    <p class="text-white/80 text-sm font-medium mb-2">Options:</p>
                                    <div class="flex flex-wrap gap-2">
                                        ${q.options.map(option => `<span class="px-2 py-1 bg-white/10 text-white rounded-lg text-sm">${option}</span>`).join('')}
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                        <button onclick="removeQuestion(${i})" class="text-red-400 hover:text-red-300 transition-colors ml-4 p-2 hover:bg-red-500/20 rounded-xl">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function clearQuestionForm() {
            document.getElementById('questionText').value = '';
            document.getElementById('optionsText').value = '';
            document.getElementById('csvFile').value = '';
            document.getElementById('aiOptionsResult').innerHTML = '';
            document.getElementById('aiExamplesResult').innerHTML = '';
            document.getElementById('questionType').value = 'Short Answer';
            document.getElementById('optionsSection').classList.add('hidden');
            document.getElementById('paragraphSection').classList.add('hidden');
        }

        function clearForm() {
            clearQuestionForm();
            document.getElementById('formTitle').value = '';
            questions = [];
            updatePreview();
            document.getElementById('createFormSection').classList.add('hidden');
            // Hide the preview section when form is cleared
            document.getElementById('formPreviewSection').classList.add('hidden');
            // Return to centered layout
            const formContainer = document.getElementById('formContainer');
            formContainer.className = 'flex justify-center';
        }

        // Fixed CORS issue by using GET request with parameters instead of POST
        async function createGoogleForm() {
            const title = document.getElementById('formTitle').value.trim();
            
            if (!title) {
                alert('Please enter a form title');
                return;
            }
            
            if (questions.length === 0) {
                alert('Please add at least one question');
                return;
            }

            document.getElementById('loadingModal').classList.remove('hidden');
            document.getElementById('loadingModal').classList.add('flex');

            try {
                // Use GET request with URL parameters to avoid CORS issues
                const params = new URLSearchParams({
                    title: title,
                    questions: JSON.stringify(questions)
                });

                const response = await fetch(`${GOOGLE_SCRIPT_URL}?${params.toString()}`, {
                    method: 'GET'
                });

                const result = await response.json();
                
                document.getElementById('loadingModal').classList.add('hidden');
                document.getElementById('loadingModal').classList.remove('flex');

                if (result.success) {
                    document.getElementById('formLink').href = result.formUrl;
                    document.getElementById('successModal').classList.remove('hidden');
                    document.getElementById('successModal').classList.add('flex');
                } else {
                    alert('Failed to create form: ' + (result.error || 'Unknown error'));
                }
            } catch (error) {
                document.getElementById('loadingModal').classList.add('hidden');
                document.getElementById('loadingModal').classList.remove('flex');
                alert('Network error: ' + error.message);
            }
        }

        async function generateFormWithAI() {
            const formTitle = document.getElementById('formTitle').value.trim();
            
            if (!formTitle) {
                alert('Please enter a form title first');
                return;
            }

            // Show loading state
            const button = event.target;
            const originalText = button.innerHTML;
            button.innerHTML = '🤖 Generating...';
            button.disabled = true;

            try {
                const prompt = `Generate a complete Google Form for: "${formTitle}"

Create 5-8 relevant questions with appropriate types. Include:
- 1-2 short answer questions
- 1-2 paragraph questions  
- 2-3 multiple choice questions with realistic options
- 1-2 checkbox questions with relevant options
- 1 dropdown question with appropriate choices

IMPORTANT: Return ONLY valid JSON in this exact format, no additional text:
{
  "title": "Form Title",
  "questions": [
    {
      "text": "Question text here",
      "type": "Short Answer",
      "options": []
    },
    {
      "text": "Question text here",
      "type": "Multiple Choice", 
      "options": ["Option 1", "Option 2", "Option 3"]
    }
  ]
}

For choice-based questions (Multiple Choice, Checkboxes, Dropdown), always include options array.
For text questions (Short Answer, Paragraph), use empty options array: []`;

                const response = await callGeminiAPI(prompt);
                
                // Try to parse the JSON response
                let formData;
                try {
                    formData = JSON.parse(response);
                } catch (parseError) {
                    // Try to extract JSON from the response if it contains extra text
                    const jsonMatch = response.match(/\{[\s\S]*\}/);
                    if (jsonMatch) {
                        try {
                            formData = JSON.parse(jsonMatch[0]);
                        } catch (secondError) {
                            throw parseError; // Use original error
                        }
                    } else {
                        throw parseError;
                    }
                }
                
                try {
                    if (formData.title && formData.questions && Array.isArray(formData.questions)) {
                        // Clear existing questions
                        questions = [];
                        
                        // Add the AI-generated questions
                        formData.questions.forEach(q => {
                            if (q.text && q.type) {
                                questions.push({
                                    text: q.text,
                                    type: q.type,
                                    options: q.options || []
                                });
                            }
                        });
                        
                        // Update form title if provided
                        if (formData.title) {
                            document.getElementById('formTitle').value = formData.title;
                        }
                        
                        // Show the preview section when AI generates questions
                        // Change layout to side-by-side
                        const formContainer = document.getElementById('formContainer');
                        formContainer.className = 'grid grid-cols-1 lg:grid-cols-2 gap-8';
                        
                        document.getElementById('formPreviewSection').classList.remove('hidden');
                        document.getElementById('formPreviewSection').classList.add('fade-in');
                        
                        updatePreview();
                        document.getElementById('createFormSection').classList.remove('hidden');
                        
                        alert(`Successfully generated ${questions.length} questions with AI!`);
                    } else {
                        throw new Error('Invalid response format');
                    }
                } catch (parseError) {
                    console.error('Failed to parse AI response:', response);
                    console.error('Parse error:', parseError);
                    alert('AI generated content, but it wasn\'t in the expected JSON format. The response was:\n\n' + response.substring(0, 200) + '...\n\nPlease try again.');
                }
                
            } catch (error) {
                console.error('AI Form Generation Error:', error);
                alert('Failed to generate form with AI: ' + error.message);
            } finally {
                // Reset button
                button.innerHTML = originalText;
                button.disabled = false;
            }
        }

                 function closeSuccessModal() {
             document.getElementById('successModal').classList.add('hidden');
             document.getElementById('successModal').classList.remove('flex');
             clearForm();
         }

         function closeWelcomeModal() {
             document.getElementById('welcomeModal').classList.add('hidden');
             document.getElementById('welcomeModal').classList.remove('flex');
         }

         function showTutorial() {
             // Show a simple tutorial alert for now
             alert('🎯 How to use Form Builder Pro:\n\n1. Enter your form title\n2. Click "Generate Form with AI" to create questions automatically\n3. Review and edit the generated questions if needed\n4. Click "Create Google Form" to generate your form\n\nThat\'s it! No manual question creation needed!');
         }

        setOptionMethod('manual');
        
        // Particle Effect
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 20;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 30 + 's';
                particle.style.animationDuration = (Math.random() * 15 + 20) + 's';
                particle.style.opacity = Math.random() * 0.3 + 0.05;
                particlesContainer.appendChild(particle);
            }
        }
        
                 // Initialize particles when page loads
         document.addEventListener('DOMContentLoaded', function() {
             createParticles();
             
             // Show welcome modal on first visit
             const hasVisited = localStorage.getItem('formBuilderVisited');
             if (!hasVisited) {
                 document.getElementById('welcomeModal').classList.remove('hidden');
                 document.getElementById('welcomeModal').classList.add('flex');
                 localStorage.setItem('formBuilderVisited', 'true');
             }
             
             // Mobile optimizations
             if (window.innerWidth <= 768) {
                 // Reduce particle count on mobile for better performance
                 const particles = document.querySelectorAll('.particle');
                 particles.forEach((particle, index) => {
                     if (index > 10) particle.remove();
                 });
                 
                 // Add touch-friendly interactions
                 document.querySelectorAll('button').forEach(button => {
                     button.addEventListener('touchstart', function() {
                         this.style.transform = 'scale(0.95)';
                     });
                     button.addEventListener('touchend', function() {
                         this.style.transform = '';
                     });
                 });
             }
         });
    </script>
</body>
</html>